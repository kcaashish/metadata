package main

import (
	"github.com/oarkflow/metadata"
)

func main() {
	source, destination := conn()

	err := metadata.MigrateViews(source, destination)
	if err != nil {
		panic(err)
	}

	/*err := metadata.CloneTable(source, destination, "tbl_patient_event", "")
	if err != nil {
		panic(err)
	}*/

}

func conn() (metadata.DataSource, metadata.DataSource) {
	cfg1 := metadata.Config{
		Host:     "localhost",
		Port:     3307,
		Driver:   "mysql",
		Username: "root",
		Password: "root",
		Database: "cleardb",
	}
	cfg := metadata.Config{
		Host:     "localhost",
		Port:     5432,
		Driver:   "postgresql",
		Username: "postgres",
		Password: "postgres",
		Database: "clear",
	}
	source := metadata.New(cfg1)
	destination := metadata.New(cfg)
	return source, destination
}

/*
2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_provider.display_name" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[1.773ms] [rows:0] drop view if exists vw_active_de;create view vw_active_de as select "tbl_event_suspend"."encounter_uid" as "encounter_uid","tbl_event_suspend"."work_item_uid" as "work_item_uid","tbl_event_suspend"."suspend_reason" as "suspend_reason","tbl_provider"."display_name" as "display_name","tbl_user"."user_email_address" as "user_email_address","tbl_user"."user_first_name" as "user_first_name","tbl_user"."user_last_name" as "user_last_name","tbl_event_suspend"."suspend_released" as "suspend_released","tbl_provider"."provider_email" as "provider_email","tbl_facility"."facility_name" as "facility_name","tbl_work_item"."work_item_image" as "work_item_image" from ((((("tbl_event_suspend" join "tbl_provider" on(("tbl_provider"."provider_email" = "tbl_event_suspend"."suspend_provider"))) join "tbl_provider_wi" on(("tbl_provider_wi"."provider_uid" = "tbl_provider"."provider_uid"))) join "tbl_user" on(("tbl_user"."user_uid" = "tbl_provider_wi"."responsible_user_uid"))) join "tbl_work_item" on(("tbl_work_item"."work_item_uid" = "tbl_event_suspend"."work_item_uid"))) join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) where (("tbl_event_suspend"."suspend_released" <> 1) and ("tbl_event_suspend"."suspend_provider" <> '')) group by "tbl_event_suspend"."suspend_uid","tbl_user"."user_email_address";
ERROR: column "tbl_provider.display_name" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.334ms] [rows:0] drop view if exists vw_active_suspend_staging;create view vw_active_suspend_staging as select "event"."suspend_uid" as "suspend_uid",if((("tbl_user_type"."user_type" = 'g_suspend_mgr') or (("tbl_user_type"."user_type" = 'g_client_suspend_mgr') and ("reason"."suspend_category" = 'client'))),"tbl_user"."user_email_address","respuser"."user_email_address") as "user_email_address","event"."encounter_uid" as "encounter_uid",date_format("tbl_encounter"."encounter_dos",'%m/%d/%y') as "encounter_dos","event"."suspend_reason" as "suspend_reason","tbl_encounter"."patient_fin" as "patient_fin","tbl_encounter"."patient_mrn" as "patient_mrn","tbl_provider"."provider_lov" as "provider_lov","event"."suspend_released" as "suspend_released","event"."suspend_note" as "suspend_note","event"."work_item_uid" as "work_item_uid",round((timestampdiff(hour,"event"."user_time_entered",now()) / 24),1) as "aging",concat("tbl_encounter"."patient_name",'^/platform/suspend_detail.php?q=',unix_timestamp(),'&amp;euid=',"tbl_encounter"."encounter_uid",'&amp;wid=',"event"."work_item_uid",'&amp;provider_uid=',convert(convert(ifnull("tbl_provider"."provider_uid",'') using latin1) using utf8),'^_self') as "patient_name","tbl_facility"."facility_name" as "facility_name","tbl_provider_wi"."provider_uid" as "provider_uid" from (((((((((("tbl_event_suspend" "event" join "tbl_user_access" "access" on(("event"."work_item_uid" = "access"."work_item_uid"))) join "tbl_user_type" on(("access"."user_type_id" = "tbl_user_type"."user_type_id"))) join "tbl_user" on(("access"."user_uid" = "tbl_user"."user_uid"))) join "tbl_encounter" on(("tbl_encounter"."encounter_uid" = "event"."encounter_uid"))) join "tbl_facility" on(("tbl_encounter"."facility_id" = convert("tbl_facility"."client_disposition_name" using utf8)))) join "tbl_encounter_detail" on(("tbl_encounter_detail"."encounter_uid" = "event"."encounter_uid"))) left join "tbl_suspend_reason" "reason" on((("reason"."reason_description" = "event"."suspend_reason") and ("reason"."work_item_uid" = "event"."work_item_uid")))) left join "tbl_provider" on(("event"."suspend_provider" = "tbl_provider"."provider_email"))) left join "tbl_provider_wi" on((("tbl_provider_wi"."provider_uid" = "tbl_provider"."provider_uid") and ("tbl_provider_wi"."work_item_uid" = "event"."work_item_uid")))) left join "tbl_user" "respuser" on(("respuser"."user_uid" = "tbl_provider_wi"."responsible_user_uid"))) where (("event"."suspend_released" <> 1) and ("tbl_encounter_detail"."encounter_status" = 'suspend')) group by "event"."suspend_uid",if((("tbl_user_type"."user_type" = 'g_suspend_mgr') or (("tbl_user_type"."user_type" = 'g_client_suspend_mgr') and ("reason"."suspend_category" = 'client'))),"tbl_user"."user_email_address","respuser"."user_email_address");
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "/" (SQLSTATE 42601)
[0.209ms] [rows:0] drop view if exists vw_all_encounter_updates;create view vw_all_encounter_updates as select "tbl_coder_notes"."encounter_uid" as "encounter_uid","tbl_coder_notes"."user_time_entered" as "user_time_entered","tbl_coder_notes"."userid" as "user_email_address",concat('note: ',"tbl_coder_notes"."coder_notes") as "description" from "tbl_coder_notes" union select "tbl_encounter_activity"."encounter_uid" as "encounter_uid","tbl_encounter_activity"."created_at" as "created_at","tbl_user"."user_email_address" as "user_email_address",concat('update status: ',"tbl_encounter_status"."short_label") as "concat('update status: ', short_label)" from (("tbl_encounter_activity" join "tbl_user" on(("tbl_encounter_activity"."user_uid" = "tbl_user"."user_uid"))) join "tbl_encounter_status" on(("tbl_encounter_status"."id" = "tbl_encounter_activity"."new_status"))) union select "tbl_encounter_history"."encounter_uid" as "encounter_uid","tbl_encounter_history"."event_time" as "event_time","tbl_encounter_history"."user_uid" as "user_uid",concat("tbl_encounter_history"."work_item_description",'/',"tbl_encounter_history"."work_area",'/',"tbl_encounter_history"."detail") as "concat(work_item_description, "/", work_area, "/", detail)" from "tbl_encounter_history";
ERROR: syntax error at or near "/" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)
[0.283ms] [rows:0] drop view if exists vw_average_coding_minutes;create view vw_average_coding_minutes as select format((sum("vw_coding_time_copy"."ctime") / sum("vw_coding_time_copy"."completed")),1) as "avg_min" from "vw_coding_time_copy" where ("vw_coding_time_copy"."ctime" <= 30);
ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column vw_encounter_activity.count(tbl_encounter_history.encounter_uid) does not exist (SQLSTATE 42703)
[0.373ms] [rows:0] drop view if exists vw_average_items_per_enocounter;create view vw_average_items_per_enocounter as select format(avg("vw_encounter_activity"."count(tbl_encounter_history.encounter_uid)"),1) as "cnt" from "vw_encounter_activity";
ERROR: column vw_encounter_activity.count(tbl_encounter_history.encounter_uid) does not exist (SQLSTATE 42703)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "minute" does not exist (SQLSTATE 42703)
[0.532ms] [rows:0] drop view if exists vw_average_minutes_by_history;create view vw_average_minutes_by_history as select "tbl_encounter_history"."encounter_uid" as "encounter_uid",timestampdiff(minute,min("tbl_encounter_history"."event_time"),max("tbl_encounter_history"."event_time")) as "ctime",max("tbl_encounter_history"."event_time") as "max(tbl_encounter_history.event_time)","tbl_encounter_detail"."coding_start_time" as "coding_start_time","tbl_encounter_detail"."code_complete_ts" as "code_complete_ts",timestampdiff(second,max("tbl_encounter_history"."event_time"),"tbl_encounter_detail"."code_complete_ts") as "ttime" from ("tbl_encounter_history" join "tbl_encounter_detail" on(("tbl_encounter_detail"."encounter_uid" = "tbl_encounter_history"."encounter_uid"))) group by "tbl_encounter_history"."encounter_uid";
ERROR: column "minute" does not exist (SQLSTATE 42703)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_average_minutes_by_history" does not exist (SQLSTATE 42P01)
[0.430ms] [rows:0] drop view if exists vw_average_minutes_summary;create view vw_average_minutes_summary as select avg("vw_average_minutes_by_history"."ctime") as "avg(vw_average_minutes_by_history.ctime)" from "vw_average_minutes_by_history" where ("vw_average_minutes_by_history"."ctime" < 30);
ERROR: relation "vw_average_minutes_by_history" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_average_minutes_by_history" does not exist (SQLSTATE 42P01)
[0.275ms] [rows:0] drop view if exists vw_average_time_after_last_item;create view vw_average_time_after_last_item as select (avg("vw_average_minutes_by_history"."ttime") / 60) as "avgmin" from "vw_average_minutes_by_history" where (("vw_average_minutes_by_history"."ttime" < 1800) and ("vw_average_minutes_by_history"."ttime" > 0));
ERROR: relation "vw_average_minutes_by_history" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near ""tbl_work_item"" (SQLSTATE 42601)
[0.144ms] [rows:0] drop view if exists vw_billed_local_time;create view vw_billed_local_time as select cast(convert_tz(("tbl_encounter_detail"."dataentry_complete_ts" - interval "tbl_work_item"."report_shift_mins" minute),'utc',"tbl_facility"."timezone") as date) as "billed_date_local",("tbl_encounter_detail"."dataentry_complete_ts" - interval "tbl_work_item"."report_shift_mins" minute) as "dataentry_complete_ts","tbl_encounter_detail"."work_item_uid" as "work_item_uid","tbl_encounter_detail"."encounter_uid" as "encounter_uid" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) where ("tbl_encounter_detail"."encounter_status" in ('de_complete','de_lwbs'));
ERROR: syntax error at or near ""tbl_work_item"" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function if(boolean, character varying, unknown) does not exist (SQLSTATE 42883)
[0.274ms] [rows:0] drop view if exists vw_chargemaster_fac;create view vw_chargemaster_fac as select "tbl_event_cpt_fac"."id" as "id","tbl_event_cpt_fac"."encounter_uid" as "encounter_uid","tbl_event_cpt_fac"."procedure_num" as "procedure_num",if(("tbl_charge_master"."facility_type" = 1),"tbl_charge_master"."client_internal_code",null) as "client_internal_code","tbl_event_cpt_fac"."procedure_modifier1" as "procedure_modifier1","tbl_event_cpt_fac"."procedure_modifier2" as "procedure_modifier2",if((isnull("tbl_event_cpt_fac"."procedure_qty") or ("tbl_event_cpt_fac"."procedure_qty" = 0)),1,"tbl_event_cpt_fac"."procedure_qty") as "procedure_qty","tbl_event_cpt_fac"."procedure_provider" as "procedure_provider","tbl_event_cpt_fac"."mid_provider" as "mid_provider","tbl_charge_master"."charge_amt" as "charge_amt","tbl_charge_master"."effective_date" as "effective_date",(if((isnull("tbl_event_cpt_fac"."procedure_qty") or ("tbl_event_cpt_fac"."procedure_qty" = 0)),1,"tbl_event_cpt_fac"."procedure_qty") * "tbl_charge_master"."charge_amt") as "charge","tbl_event_cpt_fac"."work_item_uid" as "work_item_uid","tbl_event_cpt_fac"."procedure_dx" as "procedure_dx","tbl_charge_master"."profee_type" as "profee_type","tbl_charge_master"."facility_type" as "facility_type" from ("tbl_event_cpt_fac" left join "tbl_charge_master" on((("tbl_charge_master"."cpt_hcpcs_code" = "tbl_event_cpt_fac"."procedure_num") and ("tbl_charge_master"."work_item_uid" = "tbl_event_cpt_fac"."work_item_uid"))));
ERROR: function if(boolean, character varying, unknown) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function isnull(integer) does not exist (SQLSTATE 42883)
[0.231ms] [rows:0] drop view if exists vw_chargemaster_pro;create view vw_chargemaster_pro as select "tbl_event_cpt_pro"."id" as "id","tbl_event_cpt_pro"."encounter_uid" as "encounter_uid","tbl_event_cpt_pro"."procedure_num" as "procedure_num","tbl_charge_master"."client_internal_code" as "client_internal_code","tbl_event_cpt_pro"."procedure_modifier1" as "procedure_modifier1","tbl_event_cpt_pro"."procedure_modifier2" as "procedure_modifier2",if((isnull("tbl_event_cpt_pro"."procedure_qty") or ("tbl_event_cpt_pro"."procedure_qty" = 0)),1,"tbl_event_cpt_pro"."procedure_qty") as "procedure_qty","tbl_event_cpt_pro"."procedure_provider" as "procedure_provider","tbl_event_cpt_pro"."mid_provider" as "mid_provider","tbl_charge_master"."charge_amt" as "charge_amt","tbl_charge_master"."effective_date" as "effective_date",(if((isnull("tbl_event_cpt_pro"."procedure_qty") or ("tbl_event_cpt_pro"."procedure_qty" = 0)),1,"tbl_event_cpt_pro"."procedure_qty") * "tbl_charge_master"."charge_amt") as "charge","tbl_event_cpt_pro"."work_item_uid" as "work_item_uid" from ("tbl_event_cpt_pro" left join "tbl_charge_master" on((("tbl_charge_master"."cpt_hcpcs_code" = "tbl_event_cpt_pro"."procedure_num") and ("tbl_charge_master"."work_item_uid" = "tbl_event_cpt_pro"."work_item_uid"))));
ERROR: function isnull(integer) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.153ms] [rows:0] drop view if exists vw_coding_time;create view vw_coding_time as select avg(timestampdiff(minute,"tbl_encounter_detail"."coding_start_time","tbl_encounter_detail"."code_complete_ts")) as "ctime",count("tbl_encounter_detail"."encounter_status") as "completed","tbl_encounter_detail"."code_assigned" as "code_assigned","tbl_encounter_detail"."coding_start_time" as "coding_start_time","tbl_user"."user_first_name" as "user_first_name" from ("tbl_encounter_detail" join "tbl_user" on((convert("tbl_encounter_detail"."code_assigned" using utf8) = "tbl_user"."user_email_address"))) where (("tbl_encounter_detail"."encounter_status" = 'complete') or ("tbl_encounter_detail"."encounter_status" = 'de_complete')) group by "tbl_encounter_detail"."code_assigned";
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)
[0.165ms] [rows:0] drop view if exists vw_coding_time_by_date;create view vw_coding_time_by_date as select avg("vw_coding_time_copy"."ctime") as "avg(vw_coding_time_copy.ctime)",date_format("vw_coding_time_copy"."coding_start_time",'%m-%y') as "code_date","vw_coding_time_copy"."facility_name" as "facility_name" from "vw_coding_time_copy" where ("vw_coding_time_copy"."ctime" <= 30) group by date_format("vw_coding_time_copy"."coding_start_time",'%m-%y'),"vw_coding_time_copy"."facility_name";
ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.131ms] [rows:0] drop view if exists vw_coding_time_copy;create view vw_coding_time_copy as select timestampdiff(minute,"tbl_encounter_detail"."coding_start_time","tbl_encounter_detail"."code_complete_ts") as "ctime",count("tbl_encounter_detail"."encounter_status") as "completed","tbl_encounter_detail"."code_assigned" as "code_assigned","tbl_encounter_detail"."coding_start_time" as "coding_start_time","tbl_user"."user_first_name" as "user_first_name","tbl_facility"."facility_name" as "facility_name" from ((("tbl_encounter_detail" join "tbl_user" on((convert("tbl_encounter_detail"."code_assigned" using utf8) = "tbl_user"."user_email_address"))) join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) where (("tbl_encounter_detail"."encounter_status" = 'complete') or ("tbl_encounter_detail"."encounter_status" = 'de_complete')) group by "tbl_encounter_detail"."enc_detail_uid";
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.167ms] [rows:0] drop view if exists vw_completed_by_coder;create view vw_completed_by_coder as select count("tbl_encounter_detail"."code_assigned") as "count(tbl_encounter_detail.code_assigned)","tbl_encounter_detail"."code_assigned" as "code_assigned",date_format("tbl_encounter_detail"."code_complete_ts",'%m-%d-%y') as "date_format(tbl_encounter_detail.code_complete_ts,'%m-%d-%y')","tbl_user"."user_first_name" as "user_first_name" from ("tbl_encounter_detail" join "tbl_user" on((convert("tbl_encounter_detail"."code_assigned" using utf8) = "tbl_user"."user_email_address"))) where (("tbl_encounter_detail"."encounter_status" = 'complete') or ("tbl_encounter_detail"."encounter_status" = 'de_complete')) group by "tbl_encounter_detail"."code_assigned",date_format("tbl_encounter_detail"."code_complete_ts",'%m-%d-%y');
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: boolean = integer (SQLSTATE 42883)
[0.215ms] [rows:0] drop view if exists vw_cosigner;create view vw_cosigner as select distinct "vw"."work_item_uid" as "work_item_uid","vw"."provider_lov" as "provider_lov","vw"."display_name" as "display_name" from ("vw_provider_wi" "vw" join "tbl_work_item" on(("vw"."work_item_uid" = "tbl_work_item"."work_item_uid"))) where (("vw"."category" = 'physician') and (("tbl_work_item"."cosigner_required" = 0) or ("vw"."provider_lov" not in ('not required','unknown provider'))));
ERROR: operator does not exist: boolean = integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_encounter.patient_name" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.229ms] [rows:0] drop view if exists vw_count_mrn;create view vw_count_mrn as select "tbl_encounter"."patient_mrn" as "patient_mrn","tbl_encounter"."patient_name" as "patient_name","tbl_encounter"."facility_id" as "facility_id","tbl_encounter"."encounter_dos" as "encounter_dos",count("tbl_encounter"."patient_name") as "count(tbl_encounter.patient_name)" from "tbl_encounter" group by "tbl_encounter"."facility_id","tbl_encounter"."patient_mrn","tbl_encounter"."encounter_dos";
ERROR: column "tbl_encounter.patient_name" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function isnull(character varying) does not exist (SQLSTATE 42883)
[0.212ms] [rows:0] drop view if exists vw_cpt;create view vw_cpt as select "lu_cpt"."cpt_code" as "cpt_code","lu_cpt"."ld" as "ld","lu_cpt"."fd" as "fd",concat_ws('-',"lu_cpt"."cpt_code","lu_cpt"."ld") as "mask" from ("lu_cpt" left join "em_level" on((("em_level"."level" = "lu_cpt"."cpt_code") and ("em_level"."level" <> '0')))) where isnull("em_level"."level");
ERROR: function isnull(character varying) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function convert_tz(timestamp with time zone, unknown, character varying) does not exist (SQLSTATE 42883)
[0.346ms] [rows:0] drop view if exists vw_enc_volume;create view vw_enc_volume as select cast("e"."encounter_dos" as date) as "encounter_dos",cast(ifnull(convert_tz("ed"."dataentry_complete_ts",'utc',"tbl_facility"."timezone"),"ed"."dataentry_complete_ts") as date) as "billentrydate","e"."encounter_uid" as "encounter_uid","ed"."work_item_uid" as "work_item_uid","e"."encounter_ins_1" as "encounter_ins_1","ed"."encounter_status" as "encounter_status",max(((("pro"."em_level" <> '0') or ("fac"."em_level" <> '0')) and ("ed"."encounter_status" = 'de_complete'))) as "billed",max(((isnull("pro"."em_level") or ("pro"."em_level" = '0')) and (isnull("fac"."em_level") or ("fac"."em_level" = '0')) and ("ed"."encounter_status" in ('de_complete','de_lwbs','lwbs')))) as "nocharge" from ((((("tbl_encounter" "e" join "tbl_encounter_detail" "ed" on(("e"."encounter_uid" = "ed"."encounter_uid"))) left join "tbl_work_item" on(("ed"."work_item_uid" = "tbl_work_item"."work_item_uid"))) left join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) left join "tbl_event_em_pro" "pro" on((("pro"."encounter_uid" = "e"."encounter_uid") and ("pro"."work_item_uid" = "ed"."work_item_uid")))) left join "tbl_event_em_fac" "fac" on((("fac"."encounter_uid" = "e"."encounter_uid") and ("fac"."work_item_uid" = "ed"."work_item_uid")))) where ("ed"."encounter_status" in ('complete','de_complete','de_hold','de_in_progress','de_lwbs','de_pro_in_progress','de_pro_ready','de_tec_in_progress','de_tec_ready','in_progress','in_qa','lwbs','open','registered','suspend','transfer','visit_complete','visit_in_progress')) group by "e"."encounter_uid","ed"."work_item_uid";
ERROR: function convert_tz(timestamp with time zone, unknown, character varying) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.277ms] [rows:0] drop view if exists vw_encounter_updates;create view vw_encounter_updates as select "tbl_encounter"."encounter_uid" as "encounter_uid","tbl_encounter"."encounter_dos" as "encounter_dos","tbl_encounter"."patient_name" as "patient_name","tbl_encounter"."patient_fin" as "patient_fin","tbl_encounter"."load_time" as "load_time","tbl_encounter_detail"."code_complete_ts" as "code_complete_ts",max("vw_all_encounter_updates"."user_time_entered") as "latest_update","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status","tbl_encounter_status"."active" as "active",("tbl_encounter_status"."id" <> 'abandoned') as "all_status","tbl_encounter_detail"."work_item_uid" as "work_item_uid","tbl_encounter_status"."class" as "class","tbl_encounter_status"."short_label" as "short_label",count(distinct "tbl_coder_notes"."notes_uid") as "notes" from ((((((("tbl_encounter" left join "tbl_coder_notes" on(("tbl_coder_notes"."encounter_uid" = "tbl_encounter"."encounter_uid"))) left join "vw_all_encounter_updates" on(("vw_all_encounter_updates"."encounter_uid" = "tbl_encounter"."encounter_uid"))) left join "tbl_facility" on((convert("tbl_facility"."client_disposition_name" using utf8) = "tbl_encounter"."facility_id"))) join "tbl_encounter_detail" on(("tbl_encounter_detail"."encounter_uid" = "tbl_encounter"."encounter_uid"))) join "tbl_encounter_status" on(("tbl_encounter_status"."id" = "tbl_encounter_detail"."encounter_status"))) join "tbl_work_item" on(("tbl_work_item"."work_item_uid" = "tbl_encounter_detail"."work_item_uid"))) join "tbl_work_item_ref" on(("tbl_work_item_ref"."work_item_type_id" = "tbl_work_item"."work_item_type_id"))) where (not(("tbl_encounter_detail"."encounter_status" like 'dup%'))) group by "tbl_encounter"."encounter_uid";
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.229ms] [rows:0] drop view if exists vw_encounters_by_day;create view vw_encounters_by_day as select date_format("tbl_encounter"."encounter_dos",'%m/%d/%y') as "dos",count("tbl_encounter"."encounter_uid") as "encounters","tbl_facility"."facility_name" as "facility_name","tbl_contract_item"."client_uid" as "client_uid" from (("tbl_encounter" join "tbl_facility" on(("tbl_encounter"."facility_id" = convert("tbl_facility"."client_disposition_name" using utf8)))) join "tbl_contract_item" on(("tbl_contract_item"."contract_item_uid" = "tbl_facility"."contract_item_uid"))) group by "tbl_encounter"."encounter_dos","tbl_facility"."facility_name";
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_encounter_detail.work_item_uid" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.361ms] [rows:0] drop view if exists vw_fusion_charts;create view vw_fusion_charts as select distinct "tbl_encounter_detail"."work_item_uid" as "work_item_uid",count("tbl_encounter_detail"."enc_detail_uid") as "cnt","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status","tbl_work_item_ref"."work_item_description" as "work_item_description","tbl_client"."full_name" as "full_name" from (((((("tbl_encounter_detail" left join "tbl_encounter" on(("tbl_encounter"."encounter_uid" = "tbl_encounter_detail"."encounter_uid"))) left join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) left join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) join "tbl_work_item_ref" on(("tbl_work_item_ref"."work_item_type_id" = "tbl_work_item"."work_item_type_id"))) join "tbl_contract_item" on(("tbl_facility"."contract_item_uid" = "tbl_contract_item"."contract_item_uid"))) join "tbl_client" on(("tbl_contract_item"."client_uid" = "tbl_client"."client_uid"))) group by "tbl_work_item"."work_item_uid","tbl_encounter_detail"."encounter_status","tbl_work_item_ref"."work_item_type_id";
ERROR: column "tbl_encounter_detail.work_item_uid" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function date_format(timestamp with time zone, unknown) does not exist (SQLSTATE 42883)
[0.279ms] [rows:0] drop view if exists vw_goodshepherd_status;create view vw_goodshepherd_status as select date_format("tbl_encounter"."encounter_dos",'%m-%d-%y') as "encounter_dos",count("tbl_encounter_detail"."encounter_status") as "completed","tbl_encounter_detail"."encounter_status" as "encounter_status","tbl_encounter"."facility_id" as "facility_id" from ("tbl_encounter_detail" join "tbl_encounter" on(("tbl_encounter_detail"."encounter_uid" = "tbl_encounter"."encounter_uid"))) group by "tbl_encounter"."encounter_dos","tbl_encounter"."facility_id","tbl_encounter_detail"."encounter_status";
ERROR: function date_format(timestamp with time zone, unknown) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: character varying > integer (SQLSTATE 42883)
[0.319ms] [rows:0] drop view if exists vw_gs_lv_admit;create view vw_gs_lv_admit as select "gs_longview_structure"."acct" as "acct","gs_longview_structure"."adm_date" as "adm_date" from "gs_longview_structure" where ("gs_longview_structure"."adm_date" > 1) union select "gs_kilgore_structure"."acct" as "acct","gs_kilgore_structure"."adm_date" as "adm_date" from "gs_kilgore_structure" where ("gs_kilgore_structure"."adm_date" > 1) union select "gs_northpark_structure"."acct" as "acct","gs_northpark_structure"."adm_date" as "adm_date" from "gs_northpark_structure" where ("gs_northpark_structure"."adm_date" > 1);
ERROR: operator does not exist: character varying > integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function format(bigint, unknown) does not exist (SQLSTATE 42883)
[0.185ms] [rows:0] drop view if exists vw_gs_monthly_count;create view vw_gs_monthly_count as select "tbl_encounter"."encounter_dos" as "encounter_dos","tbl_encounter"."facility_id" as "facility_id",format(count("tbl_encounter"."encounter_uid"),'#,###.##') as "encounters",format((count("tbl_encounter"."encounter_uid") * 3.70),'#,###.##') as "total charge",date_format("tbl_encounter"."load_time",'%b %y') as "month" from "tbl_encounter" group by "tbl_encounter"."facility_id","tbl_encounter"."encounter_dos";
ERROR: function format(bigint, unknown) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_encounter_detail.encounter_status" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.272ms] [rows:0] drop view if exists vw_gs_status;create view vw_gs_status as select count("tbl_encounter_detail"."encounter_status") as "as complete","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where (("tbl_encounter_detail"."encounter_status" = 'complete') and (("tbl_encounter_detail"."qa_flag" - "tbl_encounter_detail"."qa_complete") = 0)) group by "tbl_facility"."facility_name" union select count("tbl_encounter_detail"."encounter_status") as "de complete","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where (("tbl_encounter_detail"."encounter_status" = 'de_complete') and (("tbl_encounter_detail"."qa_flag" - "tbl_encounter_detail"."qa_complete") = 0)) group by "tbl_facility"."facility_name" union select count("tbl_encounter_detail"."encounter_status") as "in qa","tbl_facility"."facility_name" as "facility_name",'qa' as "qa" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where (("tbl_encounter_detail"."encounter_status" = 'complete') and (("tbl_encounter_detail"."qa_flag" - "tbl_encounter_detail"."qa_complete") <> 0)) group by "tbl_facility"."facility_name" union select count("tbl_encounter_detail"."encounter_status") as "de complete","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where ("tbl_encounter_detail"."encounter_status" = 'suspend') group by "tbl_facility"."facility_name" union select count("tbl_encounter_detail"."encounter_status") as "de complete","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where ("tbl_encounter_detail"."encounter_status" = 'open') group by "tbl_facility"."facility_name" union select count("tbl_encounter_detail"."encounter_status") as "de complete","tbl_facility"."facility_name" as "facility_name","tbl_encounter_detail"."encounter_status" as "encounter_status" from (("tbl_encounter_detail" join "tbl_work_item" on(("tbl_encounter_detail"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) where ("tbl_encounter_detail"."encounter_status" = 'in_progress') group by "tbl_facility"."facility_name";
ERROR: column "tbl_encounter_detail.encounter_status" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)
[0.445ms] [rows:0] drop view if exists vw_icd9_fac;create view vw_icd9_fac as select "lu_icd9"."icd9_code" as "icd9_code",concat_ws('-',"lu_icd9"."icd9_code","lu_icd9"."long_description") as "mask" from "lu_icd9" where (("lu_icd9"."validity" = 'c') and ("lu_icd9"."code_type" = 3));
ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)
[0.353ms] [rows:0] drop view if exists vw_icd9_fac_1;create view vw_icd9_fac_1 as select "lu_icd9"."icd9_code" as "icd9_code","lu_icd9"."long_description" as "long_description","lu_icd9"."code_no_periods" as "code_no_periods","lu_icd9"."full_description" as "full_description",concat_ws('-',"lu_icd9"."icd9_code","lu_icd9"."long_description") as "mask" from "lu_icd9" where (("lu_icd9"."validity" = 'c') and ("lu_icd9"."code_type" = 1));
ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)
[0.344ms] [rows:0] drop view if exists vw_icd9_fac_3;create view vw_icd9_fac_3 as select "lu_icd9"."icd9_code" as "icd9_code","lu_icd9"."long_description" as "long_description","lu_icd9"."full_description" as "full_description",concat_ws('-',"lu_icd9"."icd9_code","lu_icd9"."long_description") as "mask" from "lu_icd9" where (("lu_icd9"."validity" = 'c') and ("lu_icd9"."code_type" = 3));
ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)
[0.315ms] [rows:0] drop view if exists vw_icd9_pro;create view vw_icd9_pro as select "lu_icd9"."icd9_code" as "icd9_code",concat_ws('-',"lu_icd9"."icd9_code","lu_icd9"."long_description") as "mask" from "lu_icd9" where (("lu_icd9"."validity" = 'c') and ("lu_icd9"."code_type" = 1));
ERROR: operator does not exist: character varying = integer (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_work_item_ref.work_item_description" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.333ms] [rows:0] drop view if exists vw_lebanon_em_level;create view vw_lebanon_em_level as select "tbl_event_em_pro"."em_level" as "em_level",count("tbl_event_em_pro"."em_level") as "cnt","tbl_facility"."facility_name" as "facility_name","tbl_work_item_ref"."work_item_description" as "work_item_description" from (((("tbl_event_em_pro" join "tbl_work_item" on(("tbl_work_item"."work_item_uid" = "tbl_event_em_pro"."work_item_uid"))) join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) join "tbl_work_item_ref" on(("tbl_work_item"."work_item_type_id" = "tbl_work_item_ref"."work_item_type_id"))) join "tbl_encounter_detail" on(("tbl_event_em_pro"."encounter_uid" = "tbl_encounter_detail"."encounter_uid"))) where (("tbl_encounter_detail"."encounter_status" = 'de_complete') and ("tbl_facility"."facility_name" = 'lebanon ed')) group by "tbl_event_em_pro"."em_level","tbl_facility"."facility_name";
ERROR: column "tbl_work_item_ref.work_item_description" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.299ms] [rows:0] drop view if exists vw_loaded_gs;create view vw_loaded_gs as select "tbl_encounter"."encounter_uid" as "encounter_uid","loaded"."loaded" as "loaded" from ("loaded" join "tbl_encounter" on(("loaded"."loaded" = convert("tbl_encounter"."patient_fin" using utf8))));
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_event_suspend.suspend_reason" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.256ms] [rows:0] drop view if exists vw_mercy_lebanon_suspends;create view vw_mercy_lebanon_suspends as select "tbl_event_suspend"."suspend_reason" as "reason","tbl_event_suspend"."suspend_note" as "notes",count("tbl_event_suspend"."suspend_reason") as "#" from ("tbl_event_suspend" join "tbl_encounter_detail" on(("tbl_event_suspend"."encounter_uid" = "tbl_encounter_detail"."encounter_uid"))) where (("tbl_event_suspend"."suspend_released" = 0) and ("tbl_event_suspend"."work_item_uid" = 32)) group by "tbl_event_suspend"."suspend_note";
ERROR: column "tbl_event_suspend.suspend_reason" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_queue_base" does not exist (SQLSTATE 42P01)
[0.218ms] [rows:0] drop view if exists vw_pat_header;create view vw_pat_header as select "vw_queue_base"."work_item_uid" as "work_item_uid","e"."encounter_uid" as "encounter_uid","e"."patient_name" as "patient_name","e"."patient_sex" as "patient_sex","e"."patient_gender_assigned_at_birth" as "patient_gender_assigned_at_birth","e"."encounter_dos" as "encounter_dos","e"."patient_dob" as "patient_dob","e"."encounter_location" as "encounter_location","vw_queue_base"."location_label" as "location_label","e"."encounter_disch_disp" as "encounter_disch_disp","e"."patient_mrn" as "patient_mrn","e"."patient_fin" as "patient_fin","vw_queue_base"."age" as "age","vw_queue_base"."facility_name" as "facility_name","vw_queue_base"."encounter_status" as "encounter_status","e"."encounter_chief_complaint" as "encounter_chief_complaint","e"."encounter_ins_type" as "encounter_ins_type","e"."encounter_ins_1" as "encounter_ins_1","e"."encounter_assign_provider1" as "encounter_assign_provider1","e"."encounter_type" as "encounter_type","e"."injury_real_date" as "injury_real_date","e"."lmp_date" as "lmp_date","vw_queue_base"."qa_flag" as "qa_flag",(((6 * 60) * 60) - timestampdiff(second,(case "vw_queue_base"."encounter_status" when 'in_progress' then "vw_queue_base"."coding_start_time" when 'in_qa' then "vw_queue_base"."qa_start_time" when 'de_in_progress' then "vw_queue_base"."dataentry_start_time" when 'de_tec_in_progress' then "vw_queue_base"."dataentry_start_time" when 'de_pro_in_progress' then "vw_queue_base"."dataentry_start_time" end),utc_timestamp())) as "time_remaining_secs","vw_queue_base"."code_assigned" as "code_assigned","e"."admitted" as "admitted","e"."encounter_ama" as "encounter_ama","e"."encounter_lwbs" as "encounter_lwbs","e"."inpatient" as "inpatient","e"."observation" as "observation","e"."emergency" as "emergency","e"."outpatient" as "outpatient","e"."discharge" as "discharge","e"."transfer" as "transfer","e"."enc_admit" as "enc_admit","vw_queue_base"."qa_requested" as "qa_requested","vw_queue_base"."is_transfer" as "is_transfer",("vw_queue_base"."code_complete" = 0) as "pre_coding_qa","e"."transfer_dest" as "transfer_dest","e"."encounter_dos_end" as "encounter_dos_end" from ("tbl_encounter" "e" join "vw_queue_base" on(("e"."encounter_uid" = "vw_queue_base"."encounter_uid")));
ERROR: relation "vw_queue_base" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_queue_base" does not exist (SQLSTATE 42P01)
[0.193ms] [rows:0] drop view if exists vw_patient_list_not_assigned;create view vw_patient_list_not_assigned as select "vw_queue_base"."work_item_uid" as "work_item_uid","vw_queue_base"."encounter_uid" as "encounter_uid","vw_queue_base"."dos" as "dos","vw_queue_base"."dob" as "dob","vw_queue_base"."patient_name" as "patient_name","vw_queue_base"."patient_fin" as "patient_fin","vw_queue_base"."patient_mrn" as "patient_mrn","vw_queue_base"."age" as "age","vw_queue_base"."facility_name" as "facility_name","vw_queue_base"."work_item_description" as "work_item_description","vw_queue_base"."encounter_type" as "encounter_type","vw_queue_base"."encounter_dos" as "encounter_dos","vw_queue_base"."code_assigned" as "code_assigned","vw_queue_base"."dataentry_assigned" as "dataentry_assigned","vw_queue_base"."qa_requested" as "qa_requested","vw_queue_base"."encounter_status" as "encounter_status","vw_queue_base"."encounter_disch_disp" as "encounter_disch_disp","vw_queue_base"."is_transfer" as "is_transfer","vw_queue_base"."encounter_dos_end" as "encounter_dos_end" from "vw_queue_base" where (((to_days(now()) - to_days("vw_queue_base"."encounter_dos")) > "vw_queue_base"."dos_delay_days") and ("vw_queue_base"."encounter_status" = 'open')) order by "vw_queue_base"."encounter_dos","vw_queue_base"."encounter_type";
ERROR: relation "vw_queue_base" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: cannot drop view vw_provider_wi because other objects depend on it (SQLSTATE 2BP01)
[0.282ms] [rows:0] drop view if exists vw_provider_wi;create view vw_provider_wi as select "tbl_provider"."provider_lov" as "provider_lov","tbl_provider"."display_name" as "display_name","tbl_provider"."provider_uid" as "provider_uid","tbl_provider"."provider_email" as "provider_email","tbl_provider"."firstname" as "firstname","tbl_provider"."lastname" as "lastname","tbl_provider"."middlename" as "middlename","tbl_facility"."facility_name" as "facility_name","tbl_work_item_ref"."work_item_description" as "work_item_description","tbl_work_item"."work_item_uid" as "work_item_uid","tbl_provider_type"."type_id" as "type_id","tbl_provider_type"."category" as "category","tbl_provider_wi"."client_ref" as "client_ref","tbl_provider_wi"."alt_client_ref" as "alt_client_ref" from ((((("tbl_provider_wi" join "tbl_provider" on(("tbl_provider_wi"."provider_uid" = "tbl_provider"."provider_uid"))) join "tbl_work_item" on(("tbl_provider_wi"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_work_item"."facility_id" = "tbl_facility"."facility_id"))) join "tbl_work_item_ref" on(("tbl_work_item"."work_item_type_id" = "tbl_work_item_ref"."work_item_type_id"))) join "tbl_provider_type" on(("tbl_provider"."type_id" = "tbl_provider_type"."type_id")));
ERROR: cannot drop view vw_provider_wi because other objects depend on it (SQLSTATE 2BP01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function sum(boolean) does not exist (SQLSTATE 42883)
[0.299ms] [rows:0] drop view if exists vw_qa_cpt_fac_summary;create view vw_qa_cpt_fac_summary as select count("vw_cpt_fac_qa"."encounter_uid") as "count(vw_cpt_fac_qa.encounter_uid)","vw_cpt_fac_qa"."userid" as "userid",sum("vw_cpt_fac_qa"."qa_disagree") as "sum(qa_disagree)",(sum("vw_cpt_fac_qa"."qa_disagree") / count("vw_cpt_fac_qa"."encounter_uid")) as "sum(qa_disagree)/count(vw_cpt_fac_qa.encounter_uid)" from "vw_cpt_fac_qa" group by "vw_cpt_fac_qa"."userid";
ERROR: function sum(boolean) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function sum(boolean) does not exist (SQLSTATE 42883)
[0.409ms] [rows:0] drop view if exists vw_qa_cpt_fac_summary_copy;create view vw_qa_cpt_fac_summary_copy as select count("vw_cpt_fac_qa"."encounter_uid") as "count(vw_cpt_fac_qa.encounter_uid)","vw_cpt_fac_qa"."userid" as "userid",sum("vw_cpt_fac_qa"."qa_disagree") as "sum(qa_disagree)",(sum("vw_cpt_fac_qa"."qa_disagree") / count("vw_cpt_fac_qa"."encounter_uid")) as "sum(qa_disagree)/count(vw_cpt_fac_qa.encounter_uid)" from "vw_cpt_fac_qa" group by "vw_cpt_fac_qa"."userid";
ERROR: function sum(boolean) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: function sum(boolean) does not exist (SQLSTATE 42883)
[0.274ms] [rows:0] drop view if exists vw_qa_dx_fac_summary;create view vw_qa_dx_fac_summary as select count("vw_dx_fac_qa"."encounter_uid") as "count(vw_dx_fac_qa.encounter_uid)","vw_dx_fac_qa"."userid" as "userid",sum("vw_dx_fac_qa"."qa_disagree") as "sum(qa_disagree)",(sum("vw_dx_fac_qa"."qa_disagree") / count("vw_dx_fac_qa"."encounter_uid")) as "sum(qa_disagree)/count(vw_dx_fac_qa.encounter_uid)" from "vw_dx_fac_qa" group by "vw_dx_fac_qa"."userid";
ERROR: function sum(boolean) does not exist (SQLSTATE 42883)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near ""tbl_work_item"" (SQLSTATE 42601)
[0.312ms] [rows:0] drop view if exists vw_queue_base;create view vw_queue_base as select "d"."work_item_uid" as "work_item_uid","tbl_encounter"."encounter_uid" as "encounter_uid",date_format("tbl_encounter"."encounter_dos",'%m/%d/%y') as "dos",date_format("tbl_encounter"."patient_dob",'%m/%d/%y') as "dob","tbl_encounter"."patient_name" as "patient_name","tbl_encounter"."patient_fin" as "patient_fin","tbl_encounter"."patient_mrn" as "patient_mrn",round(((to_days("tbl_encounter"."encounter_dos") - to_days("tbl_encounter"."patient_dob")) / 365.25),1) as "age","tbl_facility"."facility_name" as "facility_name","tbl_work_item_ref"."work_item_description" as "work_item_description","tbl_encounter"."encounter_type" as "encounter_type","tbl_work_item"."dos_delay_days" as "dos_delay_days","d"."encounter_status" as "encounter_status","tbl_encounter"."encounter_dos" as "encounter_dos","d"."qa_flag" as "qa_flag","d"."qa_complete" as "qa_complete","d"."qa_complete_ts" as "qa_complete_ts","d"."code_assigned" as "code_assigned","d"."qa_assigned" as "qa_assigned","d"."dataentry_assigned" as "dataentry_assigned","d"."dataentry_assigned_pf" as "dataentry_assigned_pf","d"."dataentry_complete_tec" as "dataentry_complete_tec","d"."dataentry_complete_pf" as "dataentry_complete_pf","d"."coding_start_time" as "coding_start_time","d"."qa_start_time" as "qa_start_time","d"."dataentry_start_time" as "dataentry_start_time","d"."code_complete" as "code_complete","d"."code_complete_ts" as "code_complete_time_stamp",0 as "is_coding_hold",0 as "is_qa_hold","d"."qa_requested" as "qa_requested","tbl_encounter"."encounter_disch_disp" as "encounter_disch_disp",if(isnull("tbl_location_fasttrack"."location"),null,'fast track') as "location_label",(ifnull("tbl_encounter"."transfer",0) or ("tbl_transfer_dispositions"."disch_disp" is not null)) as "is_transfer",(("tbl_encounter"."encounter_dos" + interval "tbl_work_item"."dos_delay_days" day) > now()) as "is_imbargo","tbl_encounter"."encounter_dos_end" as "encounter_dos_end" from (((((("tbl_encounter" join "tbl_encounter_detail" "d" on(("tbl_encounter"."encounter_uid" = "d"."encounter_uid"))) join "tbl_work_item" on(("d"."work_item_uid" = "tbl_work_item"."work_item_uid"))) join "tbl_facility" on(("tbl_facility"."facility_id" = "tbl_work_item"."facility_id"))) join "tbl_work_item_ref" on(("tbl_work_item"."work_item_type_id" = "tbl_work_item_ref"."work_item_type_id"))) left join "tbl_location_fasttrack" on((("tbl_location_fasttrack"."work_item_uid" = "d"."work_item_uid") and ("tbl_location_fasttrack"."location" = convert("tbl_encounter"."encounter_location" using utf8))))) left join "tbl_transfer_dispositions" on((("tbl_transfer_dispositions"."work_item_uid" = "d"."work_item_uid") and ("tbl_transfer_dispositions"."disch_disp" = convert("tbl_encounter"."encounter_disch_disp" using utf8)))));
ERROR: syntax error at or near ""tbl_work_item"" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: syntax error at or near "using" (SQLSTATE 42601)
[0.267ms] [rows:0] drop view if exists vw_search;create view vw_search as select "e"."encounter_uid" as "encounter_uid","e"."encounter_dos" as "encounter_dos","e"."patient_mrn" as "patient_mrn","e"."patient_fin" as "patient_fin",round(((to_days("e"."encounter_dos") - to_days("e"."patient_dob")) / 365),1) as "age","f"."facility_name" as "facility_name","f"."facility_id" as "facility_id","e"."patient_dob" as "patient_dob","e"."patient_name" as "patient_name","wir"."work_item_description" as "work_item_description","e"."encounter_type" as "encounter_type","ecf"."procedure_num" as "cpt_fac","ecp"."procedure_num" as "cpt_pro","e"."encounter_assign_provider1" as "encounter_assign_provider1","ed"."encounter_status" as "encounter_status","eep"."em_level" as "em_pro","eef"."em_level" as "em_fac","e"."encounter_disch_disp" as "encounter_disch_disp","ed"."work_item_uid" as "work_item_uid","ecf"."procedure_dx" as "cpt_dx_fac","edp"."dx_num" as "dx_pro","edf"."dx_num" as "dx_fac" from (((((((((("tbl_encounter" "e" left join "tbl_encounter_detail" "ed" on(("ed"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_em_fac" "eef" on(("eef"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_em_pro" "eep" on(("eep"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_cpt_fac" "ecf" on(("ecf"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_cpt_pro" "ecp" on(("ecp"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_dx_fac" "edf" on(("edf"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_event_dx_pro" "edp" on(("edp"."encounter_uid" = "e"."encounter_uid"))) left join "tbl_facility" "f" on((convert("f"."client_disposition_name" using utf8) = "e"."facility_id"))) left join "tbl_work_item" "wi" on(("wi"."work_item_uid" = "f"."facility_id"))) left join "tbl_work_item_ref" "wir" on(("wir"."work_item_type_id" = "wi"."work_item_type_id")));
ERROR: syntax error at or near "using" (SQLSTATE 42601)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_event_cpt_fac.procedure_num" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)
[0.372ms] [rows:0] drop view if exists vw_top_five_cpt_fac;create view vw_top_five_cpt_fac as select distinct "tbl_event_cpt_fac"."procedure_num" as "procedure_num",count("tbl_event_cpt_fac"."procedure_num") as "as cnt",(count("tbl_event_cpt_fac"."procedure_num") / (select count("tbl_event_cpt_fac"."encounter_uid") as "as cnt2" from "tbl_event_cpt_fac")) as "name_exp_3","lu_cpt"."ld" as "ld" from ("tbl_event_cpt_fac" join "lu_cpt" on(("lu_cpt"."cpt_code" = "tbl_event_cpt_fac"."procedure_num"))) group by "lu_cpt"."cpt_code" order by count("tbl_event_cpt_fac"."procedure_num") desc limit 5;
ERROR: column "tbl_event_cpt_fac.procedure_num" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_goodshepherd_status" does not exist (SQLSTATE 42P01)
[0.206ms] [rows:0] drop view if exists vw_total_gs_completed;create view vw_total_gs_completed as select sum("vw_goodshepherd_status"."completed") as "'completed'","vw_goodshepherd_status"."facility_id" as "facility_id" from "vw_goodshepherd_status" group by "vw_goodshepherd_status"."facility_id";
ERROR: relation "vw_goodshepherd_status" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)
[0.225ms] [rows:0] drop view if exists vw_weighted_coding_time;create view vw_weighted_coding_time as select avg("vw_coding_time_copy"."ctime") as "atime","vw_coding_time_copy"."code_assigned" as "code_assigned","vw_coding_time_copy"."user_first_name" as "user_first_name",sum("vw_coding_time_copy"."completed") as "completed" from "vw_coding_time_copy" where ("vw_coding_time_copy"."ctime" <= 30) group by "vw_coding_time_copy"."code_assigned","vw_coding_time_copy"."user_first_name";
ERROR: relation "vw_coding_time_copy" does not exist (SQLSTATE 42P01)

2023/05/19 14:58:13 /home/sujit/Projects/oarkflow/metadata/postgres.go:205 ERROR: column "tbl_work_item_ref.work_item_description" must appear in the GROUP BY clause or be used in an aggregate function (SQLSTATE 42803)


*/
